general {
    # base_exp_dir = ./exp/CASE_NAME/wmask
    # base_exp_dir = /data/datasets/genn/diffsim/neus/exp/CASE_NAME/wmask
    base_exp_dir = /data2/datasets/xueyi/neus/exp/CASE_NAME/wmask
    # base_exp_dir = /data3/datasets/diffsim/neus/exp/CASE_NAME/wmask
    # base_exp_dir = /data3/datasets/xueyi/neus/exp/CASE_NAME/wmask


    # tag = "train_retargeted_shadow_hand_states_"
    # tag = "train_retargeted_shadow_hand_states_optstatesfromretarv3_"
    # tag = "train_retargeted_shadow_hand_states_optstatesfromretarv3_dthres_0_1_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__"
    # tag = "train_retargeted_shadow_hand_states_optrobot__lossceof_1_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__lossceof_1_nreg_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_optrobo_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_optrobo_reg001_"
    # # tag = "train_retargeted_shadow_hand_states_optrobot__seq_1_optrules_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2_optrobo_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_optrobo_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_optrobo_k2_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_optrobo_k3_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_optrobo_k4_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_optrobo_k5_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_ksonly_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_ksonly_optroborules_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_ksonly_optroborules_v2_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_ksonly_optroborules_v3_thre01_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_ksonly_optroborules_v3_thre02_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_ksonly_optroborules_v3_thre01_optrobo_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_ksonly_optroborules_v3_thre01_optrobo_thre00_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_89_optrules_frommano_thre00_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_89_optrules_frommano_thre00_real_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_89_optrules_frommano_thre01_optrobo_"
    # tag = "train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_"
    tag = "train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_optrobo_"
    tag = "train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_robooptrules_"
    tag = "train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_robooptrules_optrobo_"
    tag = "train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_robooptrules_optrobo_wglbstates_"
    tag = "train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_robooptrules_optrobo_redmaxmultistages_"
    tag = "train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_robooptrules_optrobo_redmaxmultistages_wvirtualf_"

    recording = [
        ./,
        ./models
    ]
}

dataset {
    # data_dir = ./public_data/CASE_NAME/
    # data_dir = /data/datasets/genn/diffsim/neus/public_data/CASE_NAME/
    data_dir = /data2/datasets/diffsim/neus/public_data/CASE_NAME/
    # data_dir = /data/xueyi/NeuS/public_data/CASE_NAME/
    render_cameras_name = cameras_sphere.npz
    object_cameras_name = cameras_sphere.npz

    obj_idx = 102
}

train {
    learning_rate = 5e-4
    learning_rate_actions = 5e-6
    # learning_rate = 5e-6
    # learning_rate = 5e-5
    learning_rate_alpha = 0.05
    end_iter = 300000

    # batch_size = 128 #  64
    # batch_size = 4000
    # batch_size = 3096 #  64
    batch_size = 1024 #  64
    # batch_size = 512 #  64
    #  batch_size = 256 
    # batch_size = 64 #  64 # 
    # batch_size = 2048 #  64
    validate_resolution_level = 4
    warm_up_end = 5000
    anneal_end = 0
    use_white_bkgd = False

    # save_freq = 10000
    save_freq = 10000
    val_freq = 20 #  2500
    val_mesh_freq = 20 #  5000
    report_freq = 10
    ### igr weight ###
    igr_weight = 0.1
    mask_weight = 0.1
}
 
model {
    

    load_redmax_robot_actions = "/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_01_sqrt_mt_02_proj_wpene_adc_001_sdfascontactdist_contact_k_001_1_2_nv2_v2_ndiff_glbonly_frnormal_v1_proj_glb_delta_lr0_wokine_r_k_10_30_wresist_0_nepen_/checkpoints/ckpt_128000.pth"
    load_optimized_init_transformations = "/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_01_sqrt_mt_02_proj_wpene_adc_001_sdfascontactdist_contact_k_001_1_2_nv2_v2_ndiff_glbonly_frnormal_v1_proj_glb_delta_lr0_wokine_r_k_10_30_wresist_0_nepen_/checkpoints/ckpt_128000.pth"
    
    penetration_proj_k_to_robot = 30.0

    penetration_proj_k_to_robot = 50
    penetration_proj_k_to_robot = 40
# penetration_proj_k_to_robot = 30
    penetrating_depth_penalty = 1.0
    penetrating_depth_penalty = 0.0
    train_states = True

    penetration_proj_k_to_robot = 300.0
    penetration_proj_k_to_robot = 500.0
    penetration_proj_k_to_robot = 2000.0
    penetration_proj_k_to_robot = 20000.0
    penetration_proj_k_to_robot = 200000.0
    penetration_proj_k_to_robot = 100000.0
    penetration_proj_k_to_robot = 100000.0
    penetration_proj_k_to_robot = 1000000.0
    penetration_proj_k_to_robot = 10000000.0
    penetration_proj_k_to_robot = 4000000000.0

    ## for substep 10 ##
    # penetration_proj_k_to_robot = 8000000000.0
    # penetration_proj_k_to_robot = 16000000000.0
    ## for substep 10 ##


    minn_dist_threshold = 0.000
    # minn_dist_threshold = 0.01
    obj_mass = 100.0
    obj_mass = 30.0

    load_optimized_init_actions = "/data2/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v13_optim_robot_hand_from_mano_models_opt_actions_ns40_nr04_w_0_0_pdeltamotion_optdeltmotiononly_wthres_0_001_001_optrules_/checkpoints/ckpt_011000.pth"
    load_optimized_init_actions= "/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_sqrt_mt_02_proj_wpene_adc_001_sdfascontactdist_contact_k_001_1_2_nv2_v2_ndiff_glbonly_frnormal_v1_proj_glb_delta_lr0_wokine_r_k_10000_trainstates_for_tests_fingerc_nepne_lrn5_wglb_onlyhandtrack_/checkpoints/ckpt_009000.pth"
    load_optimized_init_actions = "/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_wglb_onlyhandtrack_sf_10000_/checkpoints/ckpt_052000.pth"

    load_optimized_init_actions ="/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_wglb_onlyhandtrack_sf_10000000_init3_wfrics_ts_0_005_subs_10_svmore_dp_/checkpoints/ckpt_027000.pth"
    optimize_rules = True

    use_mano_hand_for_test = False
    use_mano_hand_for_test = True

    ckpt_fn = "/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_wglb_onlyhandtrack_sf_10000000_100000000_init3_wfrics_ts_0_0005_svmore_dp_quasista_fr2__mano_opt_/checkpoints/ckpt_001000.pth"

    ckpt_fn = "/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_wglb_onlyhandtrack_sf_10000000_100000000_init3_wfrics_ts_0_0005_svmore_dp_quasista_fr2__mano_opt_/checkpoints/ckpt_005000.pth"

    train_residual_friction = False
    train_residual_friction = True

    use_LBFGS = True
    use_LBFGS = False

    ### optimized init actions ### ## ptimized
    load_optimized_init_actions = "/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_wglb_onlyhandtrack_sf_10000_/checkpoints/ckpt_052000.pth"
    use_mano_hand_for_test = False # use the dynamic mano model here #

    ckpt_fn = "/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_wglb_onlyhandtrack_sf_10000000_100000000_init3_wfrics_ts_0_0005_svmore_dp_quasista_fr2__mano_opt_div20_resfric_/checkpoints/ckpt_521000.pth" ## sue the ckt fn #
    train_residual_friction = True ## just for setting the desired spring kas and kbs for the spring values of the contact and the friction ##

    optimize_rules = False
    
    ### set the actions and jckpts ##
    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_wglb_onlyhandtrack_sf_10000000_100000000_init3_wfrics_ts_0_0005_svmore_dp_quasista_fr2__mano_opt_div20_resfric_test_dyn_mano_model_states_/checkpoints/ckpt_191000.pth"
    
    ckpt_fn = "/data3/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_wglb_onlyhandtrack_sf_10000000_100000000_init3_wfrics_ts_0_0005_svmore_dp_quasista_fr2__mano_opt_div20_resfric_test_dyn_mano_model_states_/checkpoints/ckpt_191000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__thres_000_wglb_onlyhandtrack_sf_10000000_100000000_init3_wfrics_ts_0_0005_svmore_dp_quasista_fr2__mano_opt_div20_resfric_test_dyn_mano_model_states_/checkpoints/ckpt_191000.pth"

    
    extract_delta_mesh = False
    # extract_delta_mesh = True # evaluating the delta mesh #
    # delta_mesh_ckpt_fn = "/data2/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime/wmask_reverse_value_totviews_tag_act_xs_def_n5_bending_net_val_more_ts_3_bending_sv/checkpoints/ckpt_080000.pth"
    freeze_weights = True
    # gt_act_xs_def = True
    gt_act_xs_def = False
    use_bending_network =  True
    ### for ts = 3 ###
    # use_delta_bending = False
    ### for ts = 3 ###
    use_delta_bending = True
    # use_bending_network = 
    # sv_mesh_root = "" # "/data2/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime/wmask_reverse_value_totviews_tag_act_xs_def_n5_bending_net/meshes"
    sv_mesh_root = "/data/xueyi/NeuS/exp/hand_test_routine_2_light_color_wtime/wmask_reverse_value_totviews_tag_act_xs_def_n5_bending_net_val_more_ts_7_delta_bending_sv_resume_v2_split_bending_/meshes"
    use_passive_nets = True
    # use_passive_nets = False # sv mesh root #

    use_split_network = True

    delta_ckpt_fn = "/data/xueyi/NeuS/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_act_xs_def_n5_bending_net_val_more_ts_5_bending_sv_npassivenets_passivenets_passive_def_v2/checkpoints/ckpt_030000.pth"

    # other_sdf_net_ckpt_fn = "/data2/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_act_xs_def_n5_bending_net_val_more_ts_1_bending_sv_npassivenets_passivenets_passive_def_motion_compositional_raisesdf_pmesh_/checkpoints/ckpt_001000.pth"
    other_sdf_net_ckpt_fn = "/data/xueyi/NeuS/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_act_xs_def_n5_bending_net_val_more_ts_1_bending_sv_npassivenets_passivenets_passive_def_motion_compositional_raisesdf_pmesh_/checkpoints/ckpt_005000.pth"

    # delta_mesh_ckpt_fn = "/data2/datasets/diffsim/neus/exp/hand_test_routine_2_light_color_wtime/wmask_reverse_value_totviews_tag_act_xs_def_n5_bending_net_val_more_ts_3_bending_sv/checkpoints/ckpt_300000.pth"

    # /data/xueyi/NeuS/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_ts_7_force_v9_spring_coef_poly_coef_/checkpoints/ckpt_001000.pth
    pre_opt_rules = "/data/xueyi/NeuS/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_ts_7_force_v9_spring_coef_poly_coef_/checkpoints/ckpt_001000.pth"

    delta_mesh_ckpt_fn = "/data/xueyi/NeuS/exp/hand_test_routine_2_light_color_wtime/wmask_reverse_value_totviews_tag_act_xs_def_n5_bending_net_val_more_ts_5_delta_bending_sv_resume_v2/checkpoints/ckpt_070000.pth"

    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_30_/checkpoints/ckpt_080000.pth"

    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_30_manoobj_2_/checkpoints/ckpt_050000.pth"
    
    ## 
    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_30_manoobj_2_/checkpoints/ckpt_1290000.pth"


    penetration_determining = "plane_primitives"
    # penetration_determining = "sdf_of_canon"
    obj_sdf_fn = "/home/xueyi/diffsim/NeuS/raw_data/camera.npy"


    n_timesteps = 3 #  
    # n_timesteps = 5 # 
    n_timesteps = 7
    n_timesteps = 60

    


    using_delta_glb_trans = True
    using_delta_glb_trans = False
    # train_multi_seqs = True

    # minn_dist_threshold = 0.05
    # minn_dist_threshold = 0.01
    # minn_dist_threshold = 0.005

    optimize_with_intermediates = False
    optimize_with_intermediates = True


    loss_tangential_diff_coef = 1000
    loss_tangential_diff_coef = 0

    

    #### loss weigths ####
    # finger_tracking_loss = 0.0
    # finger_cd_loss = 0.0
    # tracking_loss = 1.0
    # penetrating_depth_penalty = 0.1
    # ragged_dist = 100


    

    
    # load_only_glb = False # points tracking losses #
    # load_only_glb = True # load_only_glb or not 


    optimize_active_object = False
    optimize_active_object = True

    # optimize_expanded_pts = False
    # optimize_expanded_pts = True

    no_friction_constraint = False

    optimize_glb_transformations = True

    # /home/xueyi/diffsim/DiffHand/assets/hand_sphere_only_hand_testt.xml
    # sim_model_path = "/root/diffsim/DiffHand/assets/hand_sphere_only_hand_test.xml"
    # sim_model_path = "/home/xueyi/diffsim/DiffHand/assets/hand_sphere_only_hand_test_with_obj.xml"
    sim_model_path = "/home/xueyi/diffsim/DiffHand/assets/hand_sphere_only_hand_testt.xml"
    # sim_model_path = "/data/xueyi/diffsim/NeuS/rsc/mano/mano_mean_nocoll_simplified.urdf"
    mano_sim_model_path =  "/home/xueyi/diffsim/NeuS/rsc/mano/mano_mean_nocoll_simplified.urdf"

    mano_sim_model_path = "/home/xueyi/diffsim/NeuS/rsc/mano/mano_mean_wcollision_scaled_scaled_0_9507.urdf"
    mano_sim_model_path = "/home/xueyi/diffsim/NeuS/rsc/mano/mano_mean_wcollision_scaled_scaled_0_9507_nroot.urdf"
    mano_mult_const_after_cent = 1.0
    sim_num_steps = 1000000

    bending_net_type = "active_force_field_v9"
    bending_net_type = "active_force_field_v10"
    bending_net_type = "active_force_field_v11"
    bending_net_type = "active_force_field_v12"
    bending_net_type = "active_force_field_v13"
    # bending_net_type = "active_force_field_v14"
    # bending_net_type = "active_force_field_v13_lageu"

    bending_net_type = "active_force_field_v15"
    bending_net_type = "active_force_field_v18"    


    ### try to train the residual friction ? ###
    train_residual_friction = True
    optimize_rules = True

    ### plane primtivies for camera ###
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_30_manoobj_2_planeprimitives_ckpt2_trresfri_/checkpoints/ckpt_140000.pth"
    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_30_manoobj_2_planeprimitives_ckpt2_trresfri_/checkpoints/ckpt_140000.pth"
    
    ### cube ###
    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_train_20_cube_tst_/checkpoints/ckpt_180000.pth"
    kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/20_sv_dict.npy"

    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_trainsplit20_cube_manoobj_2_planeprimitives_ckpt2_trresfri_/checkpoints/ckpt_230000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_trainsplit20_cube_manoobj_2_planeprimitives_ckpt2_trresfri_/checkpoints/ckpt_230000.pth"

    kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/20_sv_dict.npy"
    scaled_obj_mesh_fn = "/data1/xueyi/GRAB_extracted_test/train/20_sv_dict_real_obj.obj"
    optimize_rules = False


    ## optimize rules ## penetration proj k to robot ##
    optimize_rules = True
    penetration_proj_k_to_robot = 4000000.0
    use_optimizable_params = True

    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_trainsplit20_cube_manoobj_2_planeprimitives_ckpt2_trresfri_k400000000_/checkpoints/ckpt_410000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_trainsplit20_cube_manoobj_2_planeprimitives_ckpt2_trresfri_k400000000_/checkpoints/ckpt_410000.pth"

    ## ball_primitives ## ## grab train split 25 seq ##
    penetration_determining = "ball_primitives" # uing ball primitives 
    optimize_rules = True # 
    penetration_proj_k_to_robot = 4000000.0 # 
    use_optimizable_params = True # 
    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_train_25_ball_tst_/checkpoints/ckpt_290000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_train_25_ball_tst_/checkpoints/ckpt_290000.pth"
    kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/25_sv_dict.npy"
    scaled_obj_mesh_fn = "/data1/xueyi/GRAB_extracted_test/train/25_sv_dict_real_obj.obj"
    train_with_forces_to_active = False

    # penetration_determining = "ball_primitives"
    ### obj sdf and normals for colllision eteftion and responses ##
    ### grab train seq 54; cylinder ###
    penetration_determining = "sdf_of_canon"
    optimize_rules = True
    obj_sdf_fn = "/data1/xueyi/GRAB_extracted_test/train/54_obj.npy" # sdf of the object #
    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_train_54_cylinder_tst_/checkpoints/ckpt_070000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_train_54_cylinder_tst_/checkpoints/ckpt_070000.pth"
    kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/54_sv_dict.npy"
    scaled_obj_mesh_fn = "/data1/xueyi/GRAB_extracted_test/train/54_obj.obj"
    train_with_forces_to_active = False

    ### grab train seq 1 ###
    penetration_determining = "sdf_of_canon"
    obj_sdf_fn = "/data1/xueyi/GRAB_extracted_test/train/1_obj.npy" # sdf of the object #
    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_train_1_dingshuji_tst_/checkpoints/ckpt_070000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_train_1_dingshuji_tst_/checkpoints/ckpt_070000.pth"
    kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/1_sv_dict.npy"
    scaled_obj_mesh_fn = "/data1/xueyi/GRAB_extracted_test/train/1_obj.obj"
    train_with_forces_to_active = False

    ### grab train seq 224 ###
    penetration_determining = "sdf_of_canon"
    obj_sdf_fn = "/data1/xueyi/GRAB_extracted_test/train/224_obj.npy" # sdf of the object #
    load_optimized_init_actions = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_train_224_tiantianquan_tst_/checkpoints/ckpt_070000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_train_224_tiantianquan_tst_/checkpoints/ckpt_070000.pth"
    kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/224_sv_dict.npy"
    scaled_obj_mesh_fn = "/data1/xueyi/GRAB_extracted_test/train/224_obj.obj"
    train_with_forces_to_active = False
    loss_scale_coef = 1000.0
    penetration_proj_k_to_robot_friction = 40000000.0
    penetration_proj_k_to_robot_friction = 100000000.0 # as friction coefs here #
    use_same_contact_spring_k = False


    ### optimize shadow hand in the 224 case ###
    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__shadow_finger_retargeting_scale_v2_winit_grab_seq_224_trainstatestest_wfingstates_/checkpoints/ckpt_338000.pth"
    # /home/xueyi/diffsim/DiffHand/assets/hand_sphere_only_hand_testt.xml
    # sim_model_path = "/root/diffsim/DiffHand/assets/hand_sphere_only_hand_test.xml"
    # sim_model_path = "/home/xueyi/diffsim/DiffHand/assets/hand_sphere_only_hand_test_with_obj.xml"
    sim_model_path = "/home/xueyi/diffsim/DiffHand/assets/hand_sphere_only_hand_testt.xml"
    sim_model_path = "/home/xueyi/diffsim/NeuS/rsc/shadow_hand_description/shadowhand_new.urdf"


    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_/checkpoints/ckpt_100000.pth"
    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_mano_states_grab_trainsplit20_cube_manoobj_2_planeprimitives_ckpt2_trresfri_k400000000_unitinertia_optimparas_224tiantianquan_ls1000_asfri2_expanded_set_optrobot_v3_/checkpoints/ckpt_030000.pth"
    optimize_rules = False

    ### optimized checkpoint file name ### ## train retarget
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_/checkpoints/ckpt_320000.pth"
    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_/checkpoints/ckpt_320000.pth"


    ### seq -- 54; optimized finger retargeted results ###
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__shadow_finger_retargeting_scale_v2_winit_grab_seq_54_trainstates_glbonly_towstates_/checkpoints/ckpt_337000.pth"
    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__shadow_finger_retargeting_scale_v2_winit_grab_seq_54_trainstates_glbonly_towstates_/checkpoints/ckpt_337000.pth"
    penetration_determining = "sdf_of_canon"
    optimize_rules = True
    obj_sdf_fn = "/data1/xueyi/GRAB_extracted_test/train/54_obj.npy" 
    kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/54_sv_dict.npy"
    scaled_obj_mesh_fn = "/data1/xueyi/GRAB_extracted_test/train/54_obj.obj"
    # optimize_rules = True

    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_/checkpoints/ckpt_030000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_/checkpoints/ckpt_030000.pth"
    optimize_rules = False

    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_/checkpoints/ckpt_220000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_/checkpoints/ckpt_220000.pth"
    optimize_rules = True

    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2_/checkpoints/ckpt_140000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2_/checkpoints/ckpt_140000.pth"

    optimize_rules = False

    optim_sim_model_params_from_mano = True
    optimize_rules = True


    ### MANO trained rules -> shadow hand ### ## opt robo ##
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_/checkpoints/ckpt_020000.pth"
    optim_sim_model_params_from_mano = False
    optimize_rules = False    


    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_optrobo_/checkpoints/ckpt_140000.pth"
    penetration_proj_k_to_robot_friction = 100000000.0 # as friction coefs here # ## confs ##
    penetration_proj_k_to_robot = 40000000.0 #

    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_optrobo_k2_/checkpoints/ckpt_020000.pth"
    # penetration_proj_k_to_robot = 400000000.0

    penetrating_depth_penalty = 1

    minn_dist_threshold_robot_to_obj = 0.0


    minn_dist_threshold_robot_to_obj = 0.1

    optim_sim_model_params_from_mano = True
    optimize_rules = True

    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_ksonly_optroborules_v3_thre01_/checkpoints/ckpt_170000.pth" ## ckpt fn ##
    optim_sim_model_params_from_mano = False
    optimize_rules = False    

    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v4_ksonly_optroborules_v3_thre01_optrobo_/checkpoints/ckpt_020000.pth"
    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_/checkpoints/ckpt_020000.pth"
    optim_sim_model_params_from_mano = False
    optimize_rules = False    

    ### kinematics confgs ###
    obj_sdf_fn = "/data1/xueyi/GRAB_extracted_test/train/89_obj.npy" 
    kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/89_sv_dict.npy"
    scaled_obj_mesh_fn = "/data1/xueyi/GRAB_extracted_test/train/89_obj.obj"

    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_54_optrules_modelv2v3_frommano_/checkpoints/ckpt_020000.pth"
    load_optimized_init_transformations = ""
    optim_sim_model_params_from_mano = True
    optimize_rules = True    
    minn_dist_threshold_robot_to_obj = 0.0

    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_89_optrules_frommano_thre00_/checkpoints/ckpt_240000.pth"
    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__shadow_finger_retargeting_scale_v2_winit_grab_seq_89_trainstates_glbonly_towstates_/checkpoints/ckpt_107000.pth"
    optim_sim_model_params_from_mano = False
    optimize_rules = False    
    minn_dist_threshold_robot_to_obj = 0.1


    ### kinematics confgs ###
    obj_sdf_fn = "/data1/xueyi/GRAB_extracted_test/train/102_obj.npy" 
    kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/102_sv_dict.npy"
    scaled_obj_mesh_fn = "/data1/xueyi/GRAB_extracted_test/train/102_obj.obj"
    # ckpt_fn = ""
    load_optimized_init_transformations = ""
    optim_sim_model_params_from_mano = True
    optimize_rules = True    
    minn_dist_threshold_robot_to_obj = 0.0

    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_/checkpoints/ckpt_050000.pth"
    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__shadow_finger_retargeting_scale_v2_winit_grab_seq_102_trainstates_glbonly_towstates_/checkpoints/ckpt_047000.pth"
    optim_sim_model_params_from_mano = False
    optimize_rules = False    
    optimize_rules = True

    ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_robooptrules_/checkpoints/ckpt_030000.pth"
    load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_102_optrules_frommano_thre00_robooptrules_/checkpoints/ckpt_030000.pth"
    optimize_rules = False

    optimize_rules = True
    
    ## opt roboto ##
    opt_robo_glb_trans = True
    opt_robo_glb_rot = False # opt rot # ## opt rot ##
    opt_robo_states = True
    
    load_redmax_robot_actions_fn = "/data2/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_102_optactswreacts_/checkpoints/redmax_robot_actions_ckpt_031600.pth"

    load_redmax_robot_actions_fn  = "/data2/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_102_optactswreacts_loadacts_/checkpoint/00002219_redmax_act.npy"
    # penetration_proj_k_to_robot_friction = 10000000.0 # as friction coefs here # ## confs ##
    # penetration_proj_k_to_robot = 4000000.0 #


    # penetration_proj_k_to_robot_friction = 100000.0 # as friction coefs here # ## confs ##
    # penetration_proj_k_to_robot = 40000.0 #


    ckpt_fn = "/data2/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_train_retargeted_shadow_hand_states_optrobot__seq_102_optactswreacts_redmaxacts_rules_/checkpoints/ckpt_035459.pth"

    use_multi_stages = True
    train_with_forces_to_active = True


    ## minn 
    # minn_dist_threshold_robot_to_obj = 0.2

    # penetration_proj_k_to_robot = 400.0
    # penetration_proj_k_to_robot_friction = 100000.0 # as friction coefs here # # 

    # penetration_proj_k_to_robot_friction = 10000000.0 # as friction coefs here # ## confs ##
    # penetration_proj_k_to_robot = 4000000.0 #


    # penetration_proj_k_to_robot_friction = 100000.0 # as friction coefs here # ## confs ##
    # penetration_proj_k_to_robot = 40000.0 #


    ## 
    

    ### seq - 1 ###
    # ckpt_fn = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__shadow_finger_retargeting_scale_v2_winit_grab_seq_1_trainstates_glbonly_towstates_morecores_/checkpoints/ckpt_129000.pth"
    # load_optimized_init_transformations = "/data3/datasets/xueyi/neus/exp/hand_test_routine_2_light_color_wtime_active_passive/wmask_reverse_value_totviews_tag_forces_rule_v18__shadow_finger_retargeting_scale_v2_winit_grab_seq_1_trainstates_glbonly_towstates_morecores_/checkpoints/ckpt_129000.pth"
    # penetration_determining = "sdf_of_canon"
    # optimize_rules = True 
    # obj_sdf_fn = "/data1/xueyi/GRAB_extracted_test/train/1_obj.npy" # 
    # kinematic_mano_gt_sv_fn = "/data1/xueyi/GRAB_extracted_test/train/1_sv_dict.npy" # 
    # scaled_obj_mesh_fn = "/data1/xueyi/GRAB_extracted_test/train/1_obj.obj" # 


    
    

    # optimize_rules = False
    loss_scale_coef = 1.0 ## loss scale coef ## loss scale coef #### 



    use_opt_rigid_translations=True

    train_def = True

    # optimizable_rigid_translations = False #
    optimizable_rigid_translations=True
    
    nerf {
        D = 8,
        d_in = 4,
        d_in_view = 3,
        W = 256,
        multires = 10,
        multires_view = 4,
        output_ch = 4,
        skips=[4],
        use_viewdirs=True
    }

    sdf_network {
        d_out = 257,
        d_in = 3,
        d_hidden = 256,
        n_layers = 8,
        skip_in = [4],
        multires = 6,
        bias = 0.5,
        scale = 1.0,
        geometric_init = True,
        weight_norm = True,
    } 

    variance_network {
        init_val = 0.3
    }

    rendering_network {
        d_feature = 256,
        mode = idr,
        d_in = 9,
        d_out = 3,
        d_hidden = 256,
        n_layers = 4,
        weight_norm = True,
        multires_view = 4,
        squeeze_out = True,
    }

    neus_renderer {
        n_samples = 64,
        n_importance = 64,
        n_outside = 0,
        up_sample_steps = 4 ,
        perturb = 1.0,
    }

    bending_network {
        multires = 6,
        bending_latent_size = 32,
        d_in = 3,
        rigidity_hidden_dimensions = 64,
        rigidity_network_depth = 5,
        use_rigidity_network = False,
        bending_n_timesteps = 10,
    }
}
